import{q as V,t as F,r as c,v as D,w as H,j as e,x as n,y as v,L as h,A as N,C as O,z as q,T as d,S as $,I as f,D as z,E as S,F as M,J as R}from"./index-ZK5s_Wys.js";import{l as Z}from"./auth-CWwGZ6HQ.js";import{A as J}from"./Alert-BHcqbS_G.js";import{T as k}from"./TextField-BqMvV1-A.js";import{E as K,V as Q,a as Y,b as _}from"./VpnKeyOutlined-BdxaI0qR.js";import"./axios-BH6LnKjt.js";import"./index-Dq7h7Pqt.js";import"./Alert-l4XM499c.js";import"./Menu-ZUp_UOV4.js";const ne=()=>{const A=V(),{login:I}=F(),[o,P]=c.useState({email:"",password:""}),[i,m]=c.useState({}),[x,y]=c.useState(!1),[g,C]=c.useState(!1),[p,l]=c.useState({type:null,message:null}),W=D(),j=H(W.breakpoints.up("md")),u=(t,r)=>{let s="";return t==="email"&&(r.trim()?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(r)||(s="Please enter a valid email address (e.g., user@example.com)"):s="Email is required"),t==="password"&&(r?r.length<6&&(s="Password must be at least 6 characters long"):s="Password is required"),s},w=t=>{const{name:r,value:s}=t.target;P(a=>({...a,[r]:s})),p.type==="error"&&l({type:null,message:null}),setTimeout(()=>{var b;((b=document.getElementsByName(r)[0])==null?void 0:b.value)===s&&m(L=>({...L,[r]:u(r,s)}))},500)},E=()=>{const t={};return Object.keys(o).forEach(r=>{const s=u(r,o[r]);s&&(t[r]=s)}),m(t),Object.keys(t).length===0},B=async t=>{var r;if(t.preventDefault(),!E()){const s=Object.keys(i).length;s>0&&l({type:"error",message:`Please fix the ${s} error${s>1?"s":""} in the form before submitting.`});return}y(!0),l({type:null,message:null});try{const s={email:o.email,password:o.password},a=await Z(s);I(a.token),l({type:"success",message:"Login successful! Redirecting you to your dashboard..."}),setTimeout(()=>{A("/dashboard")},1200)}catch(s){let a="Login failed";s.response?s.response.status===401?a="Invalid email or password. Please try again.":s.response.status===403?a="Your account has been locked. Please contact support.":s.response.status>=500?a="Server error. Please try again later.":(r=s.response.data)!=null&&r.message&&(a=s.response.data.message):s.message==="Network Error"?a="Network error. Please check your internet connection.":s.message&&(a=s.message),l({type:"error",message:a})}finally{y(!1)}},T=()=>C(t=>!t);return e.jsxs(n,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #0a6cce, #6a00ea)",display:"flex",alignItems:"center",justifyContent:"center",py:{xs:4,md:0},position:"relative",overflow:"hidden"},children:[e.jsx(n,{sx:{position:"absolute",top:20,left:20,zIndex:2},children:e.jsx(v,{component:h,to:"/",startIcon:e.jsx(N,{}),sx:{color:"white",fontWeight:500,"&:hover":{backgroundColor:"rgba(255,255,255,0.1)"}},children:"Back to Home"})}),e.jsx(O,{maxWidth:"lg",sx:{zIndex:1,display:"flex",justifyContent:"center"},children:e.jsxs(q,{elevation:24,sx:{display:"flex",flexDirection:{xs:"column",md:"row"},width:"100%",maxWidth:1e3,borderRadius:4,overflow:"hidden"},children:[j&&e.jsxs(n,{sx:{flex:"1 1 50%",background:"linear-gradient(135deg, #13294B, #01579B)",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",p:4},children:[e.jsx(n,{component:"img",src:"/logo.png",alt:"Logo",sx:{height:80,mb:4}}),e.jsx(d,{variant:"h3",align:"center",sx:{fontWeight:700,mb:2},children:"Welcome Back"}),e.jsx(d,{variant:"h6",align:"center",sx:{opacity:.8,mb:4,maxWidth:400},children:"Access your personal dashboard to manage prescriptions."}),e.jsx(n,{component:"img",src:"/login-illustration.png",alt:"Illustration",sx:{maxWidth:"80%",maxHeight:220}})]}),e.jsxs(n,{sx:{flex:"1 1 50%",p:{xs:3,sm:5},backgroundColor:"#fff",display:"flex",flexDirection:"column",justifyContent:"center"},children:[!j&&e.jsxs(n,{sx:{mb:4,textAlign:"center"},children:[e.jsx(n,{component:"img",src:"/logo.png",alt:"Logo",sx:{height:60,mb:2}}),e.jsx(d,{variant:"h4",fontWeight:700,color:"primary.main",children:"Welcome Back"})]}),p.type&&e.jsx(J,{type:p.type,message:p.message||"",onClose:()=>l({type:null,message:null}),isStatic:!0}),e.jsx(d,{variant:"h5",fontWeight:600,sx:{mb:4,display:{xs:"none",md:"block"}},children:"Sign in to your account"}),e.jsx(n,{component:"form",onSubmit:B,noValidate:!0,children:e.jsxs($,{spacing:3,children:[e.jsx(k,{label:"Email Address",name:"email",type:"email",fullWidth:!0,variant:"outlined",InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(K,{})}),className:o.email?"filled-input":""},value:o.email,onChange:w,required:!0,error:!!i.email,helperText:i.email||"Enter the email you registered with",FormHelperTextProps:{sx:{opacity:i.email?1:.7}},onBlur:()=>{o.email&&m(t=>({...t,email:u("email",o.email)}))}}),e.jsx(k,{label:"Password",name:"password",type:g?"text":"password",fullWidth:!0,variant:"outlined",InputProps:{startAdornment:e.jsx(f,{position:"start",children:e.jsx(_,{})}),endAdornment:e.jsx(f,{position:"end",children:e.jsx(z,{onClick:T,"aria-label":g?"Hide password":"Show password",edge:"end",children:g?e.jsx(Q,{}):e.jsx(Y,{})})}),className:o.password?"filled-input":""},value:o.password,onChange:w,required:!0,error:!!i.password,helperText:i.password||"Minimum 6 characters",FormHelperTextProps:{sx:{opacity:i.password?1:.7}},onBlur:()=>{o.password&&m(t=>({...t,password:u("password",o.password)}))}}),e.jsx(n,{sx:{textAlign:"right"},children:e.jsx(S,{component:h,to:"/password/reset",underline:"hover",sx:{color:"primary.main"},children:"Forgot password?"})}),e.jsx(v,{fullWidth:!0,type:"submit",variant:"contained",size:"large",disabled:x,endIcon:!x&&e.jsx(R,{}),children:x?e.jsx(M,{}):"Sign In"}),e.jsxs(d,{align:"center",sx:{color:"text.secondary"},children:["Don't have an account?"," ",e.jsx(S,{component:h,to:"/register",underline:"hover",sx:{color:"primary.main",fontWeight:600},children:"Sign up"})]})]})})]})]})})]})};export{ne as default};
