import{r as a,v as G,K,M as H,N as I,j as t,O as A,P as J,w as U,x as L,Q as O,C as X,T as D,S as q,y as Q,G as Y}from"./index-ZK5s_Wys.js";import{g as _,u as $,c as ee}from"./auth-CWwGZ6HQ.js";import{A as V}from"./Alert-l4XM499c.js";import{T as f}from"./TextField-BqMvV1-A.js";import"./axios-BH6LnKjt.js";import"./index-Dq7h7Pqt.js";import"./Menu-ZUp_UOV4.js";const te={entering:{transform:"none"},entered:{transform:"none"}},Z=a.forwardRef(function(x,C){const l=G(),T={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:u,appear:M=!0,children:w,easing:N,in:y,onEnter:P,onEntered:E,onEntering:m,onExit:c,onExited:R,onExiting:F,style:g,timeout:i=T,TransitionComponent:j=K,...W}=x,p=a.useRef(null),b=H(p,I(w),C),d=e=>o=>{if(e){const h=p.current;o===void 0?e(h):e(h,o)}},v=d(m),k=d((e,o)=>{J(e);const h=A({style:g,timeout:i,easing:N},{mode:"enter"});e.style.webkitTransition=l.transitions.create("transform",h),e.style.transition=l.transitions.create("transform",h),P&&P(e,o)}),S=d(E),B=d(F),r=d(e=>{const o=A({style:g,timeout:i,easing:N},{mode:"exit"});e.style.webkitTransition=l.transitions.create("transform",o),e.style.transition=l.transitions.create("transform",o),c&&c(e)}),s=d(R),n=e=>{u&&u(p.current,e)};return t.jsx(j,{appear:M,in:y,nodeRef:p,onEnter:k,onEntered:S,onEntering:v,onExit:r,onExited:s,onExiting:B,addEndListener:n,timeout:i,...W,children:(e,{ownerState:o,...h})=>a.cloneElement(w,{style:{transform:"scale(0)",visibility:e==="exited"&&!y?"hidden":void 0,...te[e],...g,...w.props.style},ref:b,...h})})}),de=()=>{const z=G();U(z.breakpoints.up("md"));const[x,C]=a.useState(null),[l,T]=a.useState({address:"",phoneNumber:"",paymentMethod:""}),[u,M]=a.useState({}),[w,N]=a.useState(!0),[y,P]=a.useState(!1),[E,m]=a.useState({type:null,message:null}),[c,R]=a.useState({oldPassword:"",newPassword:""}),[F,g]=a.useState(""),[i,j]=a.useState({}),[W,p]=a.useState(!1),[b,d]=a.useState({type:null,message:null});a.useEffect(()=>{_().then(r=>{C(r),T({address:r.address||"",phoneNumber:r.phoneNumber||"",paymentMethod:r.paymentMethod||""})}).catch(r=>{var s,n;m({type:"error",message:((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||r.message})}).finally(()=>N(!1))},[]);const v=r=>{const{name:s,value:n}=r.target;T(e=>({...e,[s]:n})),n.trim()?M(e=>{const o={...e};return delete o[s],o}):M(e=>({...e,[s]:"Required"}))},k=async r=>{var s,n;if(r.preventDefault(),!Object.keys(u).length){P(!0),m({type:null,message:null});try{const e=await $(l);C(e),m({type:"success",message:"Profile updated"})}catch(e){m({type:"error",message:((n=(s=e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message})}finally{P(!1)}}},S=r=>{const{name:s,value:n}=r.target;s==="confirm"?(g(n),j(e=>({...e,confirm:n===c.newPassword?"":"Passwords do not match"}))):(R(e=>({...e,[s]:n})),j(n?e=>{const o={...e};return delete o[s],o}:e=>({...e,[s]:"Required"})))},B=async r=>{var s,n;if(r.preventDefault(),!(i.oldPassword||i.newPassword||i.confirm)){p(!0),d({type:null,message:null});try{await ee(c),d({type:"success",message:"Password changed"}),R({oldPassword:"",newPassword:""}),g("")}catch(e){d({type:"error",message:((n=(s=e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message})}finally{p(!1)}}};return w?t.jsx(L,{sx:{display:"flex",justifyContent:"center",mt:4},children:t.jsx(O,{})}):t.jsxs(X,{maxWidth:"sm",sx:{mt:4,mb:4},children:[t.jsx(D,{variant:"h4",gutterBottom:!0,children:"My Profile"}),E.type&&t.jsx(Z,{in:!0,children:t.jsx(V,{severity:E.type,sx:{mb:2},onClose:()=>m({type:null,message:null}),children:E.message})}),t.jsx(L,{component:"form",onSubmit:k,noValidate:!0,children:t.jsxs(q,{spacing:2,children:[t.jsx(f,{label:"Email",value:x==null?void 0:x.email,InputProps:{readOnly:!0},fullWidth:!0}),t.jsx(f,{label:"Address",name:"address",value:l.address,onChange:v,error:!!u.address,helperText:u.address,fullWidth:!0}),t.jsx(f,{label:"Phone Number",name:"phoneNumber",value:l.phoneNumber,onChange:v,error:!!u.phoneNumber,helperText:u.phoneNumber,fullWidth:!0}),t.jsx(f,{label:"Payment Method",name:"paymentMethod",value:l.paymentMethod,onChange:v,error:!!u.paymentMethod,helperText:u.paymentMethod,fullWidth:!0}),t.jsx(Q,{type:"submit",variant:"contained",disabled:y,children:y?t.jsx(O,{size:24}):"Save Profile"})]})}),t.jsx(Y,{sx:{my:4}}),t.jsx(D,{variant:"h5",gutterBottom:!0,children:"Change Password"}),b.type&&t.jsx(Z,{in:!0,children:t.jsx(V,{severity:b.type,sx:{mb:2},onClose:()=>d({type:null,message:null}),children:b.message})}),t.jsx(L,{component:"form",onSubmit:B,noValidate:!0,children:t.jsxs(q,{spacing:2,children:[t.jsx(f,{label:"Old Password",name:"oldPassword",type:"password",value:c.oldPassword,onChange:S,error:!!i.oldPassword,helperText:i.oldPassword,fullWidth:!0}),t.jsx(f,{label:"New Password",name:"newPassword",type:"password",value:c.newPassword,onChange:S,error:!!i.newPassword,helperText:i.newPassword,fullWidth:!0}),t.jsx(f,{label:"Confirm New Password",name:"confirm",type:"password",value:F,onChange:S,error:!!i.confirm,helperText:i.confirm,fullWidth:!0}),t.jsx(Q,{type:"submit",variant:"contained",disabled:W,children:W?t.jsx(O,{size:24}):"Change Password"})]})})]})};export{de as default};
